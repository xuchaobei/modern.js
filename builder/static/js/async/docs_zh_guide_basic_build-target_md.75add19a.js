(self.webpackChunkwebpack=self.webpackChunkwebpack||[]).push([["docs_zh_guide_basic_build-target_md"],{14727:function(e,s,r){"use strict";Object.defineProperty(s,"__esModule",{value:!0});!function(e,s){for(var r in s)Object.defineProperty(e,r,{enumerable:!0,get:s[r]})}(s,{frontmatter:function(){return l},toc:function(){return o},title:function(){return c},default:function(){return t}});var n=r("12151"),i=r("21447");let l=void 0,o=[{id:"默认产物",text:"默认产物",depth:2},{id:"可选类型",text:"可选类型",depth:2},{id:"并行构建",text:"并行构建",depth:2},{id:"node-产物",text:"Node 产物",depth:2},{id:"web-worker-产物",text:"Web Worker 产物",depth:2},{id:"modern-web-产物",text:"Modern Web 产物",depth:2}],c="构建产物类型";function a(e){let s=Object.assign({h1:"h1",a:"a",p:"p",code:"code",h2:"h2",strong:"strong",ul:"ul",li:"li",div:"div",button:"button",pre:"pre",span:"span"},(0,i.useMDXComponents)(),e.components);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(s.h1,{id:"构建产物类型",children:[(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#构建产物类型",children:"#"}),"构建产物类型"]}),"\n",(0,n.jsx)(s.p,{children:"Builder 支持多种构建产物类型，分别适用于不同的目标运行环境。在设置正确的产物类型后，Builder 会针对该环境优化打包结果，在构建过程中启用一些对应的插件或者配置。"}),"\n",(0,n.jsxs)(s.p,{children:["你可以通过 ",(0,n.jsx)(s.a,{href:"/builder/api/builder-core.html#createbuilder",children:"createBuilder"})," 方法的 ",(0,n.jsx)(s.code,{children:"target"})," 参数来设置产物类型。"]}),"\n",(0,n.jsxs)(s.h2,{id:"默认产物",children:[(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#默认产物",children:"#"}),"默认产物"]}),"\n",(0,n.jsxs)(s.p,{children:["默认情况下，",(0,n.jsx)(s.code,{children:"target"})," 会被设置为 ",(0,n.jsx)(s.code,{children:"'web'"}),"，并构建出",(0,n.jsx)(s.strong,{children:"运行在浏览器环境里的产物"}),"。"]}),"\n",(0,n.jsxs)(s.p,{children:["同时，Builder 会读取项目中的 ",(0,n.jsx)(s.a,{href:"https://github.com/browserslist/browserslist",target:"_blank",rel:"noopener noreferrer",children:"Browserslist 配置"}),"，以确定需要兼容的浏览器范围。"]}),"\n",(0,n.jsxs)(s.h2,{id:"可选类型",children:[(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#可选类型",children:"#"}),"可选类型"]}),"\n",(0,n.jsxs)(s.p,{children:["除了 ",(0,n.jsx)(s.code,{children:"'web'"})," 外，你还可以将 ",(0,n.jsx)(s.code,{children:"target"})," 设置为以下值："]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"'node'"}),": 构建出运行在 Node.js 环境的产物，通常用于 SSR 等场景。"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"'web-worker'"}),"：构建出运行在 Web Worker 里的产物。"]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.code,{children:"'modern-web'"}),"：构建出运行在现代浏览器里的产物。"]}),"\n"]}),"\n",(0,n.jsx)(s.p,{children:"比如构建出适用于 Node.js 环境的产物："}),"\n",(0,n.jsxs)(s.div,{className:"language-ts",children:[(0,n.jsx)(s.div,{className:""}),(0,n.jsxs)(s.div,{className:"modern-code-content",children:[(0,n.jsx)(s.button,{className:"copy"}),(0,n.jsx)(s.pre,{className:"shiki",style:{backgroundColor:"var(--shiki-color-background)"},children:(0,n.jsxs)(s.code,{children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"builder"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"createBuilder"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(provider"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  target"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'node'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"});"})}),"\n",(0,n.jsx)(s.span,{className:"line"})]})})]})]}),"\n",(0,n.jsxs)(s.h2,{id:"并行构建",children:[(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#并行构建",children:"#"}),"并行构建"]}),"\n",(0,n.jsx)(s.p,{children:"当 target 为包含多个值的数组时，Builder 会并行构建，并生成多份不同的产物。"}),"\n",(0,n.jsx)(s.p,{children:"比如同时构建浏览器产物和 SSR 产物："}),"\n",(0,n.jsxs)(s.div,{className:"language-ts",children:[(0,n.jsx)(s.div,{className:""}),(0,n.jsxs)(s.div,{className:"modern-code-content",children:[(0,n.jsx)(s.button,{className:"copy"}),(0,n.jsx)(s.pre,{className:"shiki",style:{backgroundColor:"var(--shiki-color-background)"},children:(0,n.jsxs)(s.code,{children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"builder"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"createBuilder"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"(provider"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  target"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ["}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'web'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'node'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"]"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"});"})}),"\n",(0,n.jsx)(s.span,{className:"line"})]})})]})]}),"\n",(0,n.jsxs)(s.h2,{id:"node-产物",children:[(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#node-产物",children:"#"}),"Node 产物"]}),"\n",(0,n.jsx)(s.p,{children:"指运行在 Node.js 环境的产物，通常用于 SSR 等场景。"}),"\n",(0,n.jsxs)(s.p,{children:["当 ",(0,n.jsx)(s.code,{children:"target"})," 设置为 ",(0,n.jsx)(s.code,{children:"'node'"})," 时，Builder 会进行以下处理："]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"不会生成 HTML 文件，与 HTML 相关的逻辑也不会执行，因为 Node.js 环境不需要 HTML。"}),"\n",(0,n.jsx)(s.li,{children:"不会打包或抽取 CSS 代码，但产物中会包含 CSS Modules 的 id 信息。"}),"\n",(0,n.jsx)(s.li,{children:"不会开启默认的拆包策略，但 dynamic import 依然可以生效。"}),"\n",(0,n.jsx)(s.li,{children:"不会开启热更新相关的能力。"}),"\n",(0,n.jsxs)(s.li,{children:["将 Browserslist 的默认值调整为 ",(0,n.jsx)(s.code,{children:"['node >= 14']"}),"。"]}),"\n"]}),"\n",(0,n.jsxs)(s.div,{className:"modern-directive tip",children:[(0,n.jsx)(s.p,{className:"modern-directive-title",children:"TIP"}),(0,n.jsx)(s.div,{className:"modern-directive-content",children:(0,n.jsx)(s.p,{children:"\n如果触发了并行构建，比如同时构建 web 产物和 node 产物，那么上述处理不会影响 web 产物，web 产物所需的 HTML、CSS 等文件依然会正确生成。"})})]}),"\n",(0,n.jsxs)(s.h2,{id:"web-worker-产物",children:[(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#web-worker-产物",children:"#"}),"Web Worker 产物"]}),"\n",(0,n.jsxs)(s.p,{children:["指运行在 ",(0,n.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API",target:"_blank",rel:"noopener noreferrer",children:"Web Worker"})," 环境的产物。"]}),"\n",(0,n.jsxs)(s.div,{className:"modern-directive tip",children:[(0,n.jsx)(s.p,{className:"modern-directive-title",children:"Web Worker"}),(0,n.jsx)(s.div,{className:"modern-directive-content",children:(0,n.jsx)(s.p,{children:"\nWeb Workers 是一种 JavaScript API，它允许网页在后台线程中执行脚本，与主线程（网页）分离。这意味着，您可以使用 Web Workers 来执行计算密集型或长时间运行的任务，而无需阻塞主线程，进而影响网页的性能。"})})]}),"\n",(0,n.jsxs)(s.p,{children:["当 ",(0,n.jsx)(s.code,{children:"target"})," 设置为 ",(0,n.jsx)(s.code,{children:"'web-worker'"})," 时，Builder 会进行以下处理："]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"不会生成 HTML 文件，与 HTML 相关的逻辑也不会执行，因为 Web Worker 环境不需要 HTML。"}),"\n",(0,n.jsx)(s.li,{children:"不会打包或抽取 CSS 代码，但产物中会包含 CSS Modules 的 id 信息。"}),"\n",(0,n.jsxs)(s.li,{children:["不会开启默认的拆包策略，",(0,n.jsx)(s.strong,{children:"并且 dynamic import 也不会生效"}),"，因为 Web Worker 仅运行支持单个 JavaScript 文件。"]}),"\n",(0,n.jsx)(s.li,{children:"不会开启热更新相关的能力。"}),"\n"]}),"\n",(0,n.jsxs)(s.h2,{id:"modern-web-产物",children:[(0,n.jsx)(s.a,{className:"header-anchor","aria-hidden":"true",href:"#modern-web-产物",children:"#"}),"Modern Web 产物"]}),"\n",(0,n.jsx)(s.p,{children:"指运行在现代浏览器环境的产物。"}),"\n",(0,n.jsxs)(s.div,{className:"modern-directive tip",children:[(0,n.jsx)(s.p,{className:"modern-directive-title",children:"什么是现代浏览器?"}),(0,n.jsx)(s.div,{className:"modern-directive-content",children:(0,n.jsxs)(s.p,{children:["\n现代浏览器是我们的一个约定用语，指支持 ",(0,n.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules",target:"_blank",rel:"noopener noreferrer",children:"原生 ES Modules"}),"的浏览器。"]})})]}),"\n",(0,n.jsxs)(s.p,{children:["当 ",(0,n.jsx)(s.code,{children:"target"})," 设置为 ",(0,n.jsx)(s.code,{children:"'modern-web'"})," 时，Builder 会进行以下处理："]}),"\n",(0,n.jsxs)(s.ul,{children:["\n",(0,n.jsx)(s.li,{children:"将 Browserslist 的默认值调整为："}),"\n"]}),"\n",(0,n.jsxs)(s.div,{className:"language-js",children:[(0,n.jsx)(s.div,{className:""}),(0,n.jsxs)(s.div,{className:"modern-code-content",children:[(0,n.jsx)(s.button,{className:"copy"}),(0,n.jsx)(s.pre,{className:"shiki",style:{backgroundColor:"var(--shiki-color-background)"},children:(0,n.jsxs)(s.code,{children:[(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"browserslist"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"="}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" ["})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'chrome >= 61'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'edge >= 16'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'firefox >= 60'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'safari >= 11'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsxs)(s.span,{className:"line",children:[(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"  "}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'ios_saf >= 11'"}),(0,n.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,n.jsx)(s.span,{className:"line",children:(0,n.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"];"})}),"\n",(0,n.jsx)(s.span,{className:"line"})]})})]})]})]})}var t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,i.useMDXComponents)(),e.components);return s?(0,n.jsx)(s,Object.assign({},e,{children:(0,n.jsx)(a,e)})):a(e)}}}]);